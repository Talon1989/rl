import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns


# we are running a website and we have five different banners for a single
# advertisement on our website, and say we want to figure out which advertisement
# banner is most liked by the users


n_banner = 5


df = pd.DataFrame()
for i in range(n_banner):
    df['Banner_type_%d' % i] = np.random.randint(0, 2, 100_000)


n_iter = 100_000
count = np.zeros(n_banner)
sum_rewards = np.zeros(n_banner)
q = np.zeros(n_banner)
selected_banners = []


def e_greedy(e=0.1):
    if np.random.uniform(0, 1) < e or np.sum(np.abs(q)) == 0:
        return np.random.randint(0, n_banner)
    else:
        return np.argmax(q)


for i in range(n_iter):
    banner = e_greedy(0.5)
    r = df.values[i, banner]
    sum_rewards[banner] += r
    count[banner] += 1
    q[banner] = sum_rewards[banner] / count[banner]
    selected_banners.append(banner)


print('best banner is banner n %d' % np.argmax(q))


ax = sns.countplot(selected_banners)
ax.set(xlabel='Banner', ylabel='Count')
plt.show()
plt.clf()


















































































































































































































































































































































